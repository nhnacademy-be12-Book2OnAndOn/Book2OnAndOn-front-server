<!DOCTYPE html>
<html lang="ko"
      layout:decorate="~{layout/main-layout}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title layout:fragment="title">비회원 주문/배송 조회</title>
    <th:block layout:fragment="extraHead">
        <link rel="stylesheet" th:href="@{/css/OrderHistory.css}">
        <link rel="stylesheet" th:href="@{/css/OrderHistoryGuest.css}">
        <script th:inline="javascript">
            /*<![CDATA[*/
            window.IS_MEMBER_LOGGED_IN = false;
            window.USER_ID = null;
            /*]]>*/
        </script>
    </th:block>
</head>
<body class="guest-order-page">

<main class="order-guest-shell" layout:fragment="content">
    <div class="container">
        <div class="order-guest-card">
            <header class="order-guest-header">
                <h1>비회원 주문 조회</h1>
                <p class="muted">주문 시 입력했던 정보로 배송 상태를 확인하세요.</p>
            </header>

            <section class="order-card guest-form-container" id="guestLookupSection">
                <div class="card-heading">
                    <p class="eyebrow">비회원</p>
                    <h3>비회원 주문 조회</h3>
                    <p class="muted">주문 시 입력했던 정보로 조회할 수 있습니다.</p>
                </div>
                <form class="stacked-form" id="guestLookupForm">
                    <input id="guestOrderId" placeholder="주문 번호" required type="text">
                    <input id="guestOrderer" placeholder="주문자 이름" required type="text">
                    <input id="guestPassword" placeholder="주문 비밀번호 (또는 연락처 끝 4자리)" required type="password">
                    <button class="btn-primary full" type="submit">주문 조회</button>
                </form>
                <p class="muted helper-text">
                    이미 회원이신가요? <a class="link-cta accent" th:href="@{/login}">로그인</a> 하고 전체 주문 내역을 확인하세요.
                </p>
            </section>

            <section class="order-card lookup-tips">
                <div class="tips-header">
                    <div>
                        <p class="eyebrow">안내</p>
                        <h4>조회가 잘 안 될 때</h4>
                    </div>
                    <span class="pill">TIP</span>
                </div>
                <ul class="tips-list">
                    <li>주문 번호는 결제 완료 메일 또는 문자에서 확인할 수 있어요.</li>
                    <li>주문 비밀번호 대신 연락처 끝 4자리로도 조회할 수 있습니다.</li>
                    <li>최근 주문 직후라면 1~2분 후 다시 시도해 주세요.</li>
                </ul>
                <div class="support-row">
                    <span class="muted">그래도 어렵다면 고객센터로 문의해 주세요.</span>
                    <a class="btn ghost sm" th:href="@{/support}">고객센터 바로가기</a>
                </div>
            </section>

            <section class="order-card order-list-container hidden" id="memberHistorySection">
                <p class="muted">회원 전용 영역입니다.</p>
            </section>

            <section class="order-card order-list-container hidden" id="orderDetailSection">
                <div class="card-heading">
                    <p class="eyebrow">상세</p>
                    <h3>주문 상세 정보</h3>
                </div>

                <div class="action-buttons-wrapper" id="actionButtons"></div>

                <div id="orderDetailContent"></div>
                <button class="btn-secondary ghost" id="backToHistory">목록으로 돌아가기</button>
            </section>
        </div>
    </div>
</main>

<div class="modal hidden" id="actionModal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h3 id="modalTitle"></h3>

        <div id="modalContent">
            <p><strong>주문 번호:</strong> <span id="modalOrderId"></span></p>
            <p><strong>취소/반품 금액:</strong> <span id="modalAmount"></span>원</p>

            <div class="form-group" id="reasonGroup">
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn-primary" id="confirmActionButton">확인 및 요청</button>
        </div>
    </div>
</div>

<script src="/js/OrderHistory.js"></script>
</body>
</html>
